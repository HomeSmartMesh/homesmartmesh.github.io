---
import {yaml_to_grid_images} from './grid_utils.js'

export interface Props {
    code: string;
    dirpath: string;
    expanded: boolean;
    masonry: boolean;
}

const { code, dirpath, expanded=true, masonry=false } = Astro.props as Props;

const imagesUrls = await yaml_to_grid_images(code,dirpath)
---

<div class={`container ${masonry?'masonry':'grid'}`}>
    {imagesUrls.map((image)=>(
        <div class={`item  ${masonry?'masonry':'grid'}`} style={`grid-area: span ${image.spanHeight} / span ${image.spanWidth};`}>
            {(image.ext == ".svg")?
                <object data={image.url} />:
                <img src={image.url} />
            }
        </div>
    ))}
</div>

<style>
.container.grid{
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(10rem, 1fr));
    grid-auto-rows: 10rem;
    grid-gap: 10px;
}
img{
    width: 100%;
    height: 100%;
    object-fit:cover;
}
.container.masonry{
    column-width: 20rem;
    column-gap: 1rem;
}
.item.masonry{
    break-inside: avoid;
    margin-bottom: 1rem;
}
</style>
